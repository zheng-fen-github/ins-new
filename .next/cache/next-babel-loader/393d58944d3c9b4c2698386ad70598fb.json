{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { ADD } from '../../redux/action';\nvar FeaturesComment = React.forwardRef(function (props, ref) {\n  var _useState = useState(''),\n      message = _useState[0],\n      setMessage = _useState[1];\n\n  var _useState2 = useState(props.comment),\n      commentList = _useState2[0],\n      setCommentList = _useState2[1];\n\n  var addComment = function addComment(e) {\n    var commentData, request, res;\n    return _regeneratorRuntime.async(function addComment$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            // 添加评论事件\n            e.preventDefault();\n            commentData = new FormData();\n            commentData.append('comment', message);\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(fetch(\"http://localhost:3001/post/comment/\".concat(props.id), {\n              method: 'POST',\n              body: commentData,\n              credentials: \"include\"\n            }));\n\n          case 5:\n            request = _context.sent;\n            _context.next = 8;\n            return _regeneratorRuntime.awrap(request.json());\n\n          case 8:\n            res = _context.sent;\n\n            if (typeof res == 'object') {\n              setCommentList(res);\n              setMessage('');\n            }\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var inputEv = function inputEv(e) {\n    var button = ref.current.children[1];\n    var submitBu = button.children[0];\n\n    if (e.target.value.length > 0) {\n      button.classList.add('pink');\n      submitBu.classList.add('ok');\n    } else {\n      button.classList.remove('pink');\n      submitBu.classList.remove('ok');\n    }\n\n    setMessage(e.target.value);\n  };\n\n  return __jsx(\"div\", {\n    className: \"jsx-3581091881\" + \" \" + \"comment-list\"\n  }, __jsx(\"ul\", {\n    className: \"jsx-3581091881\"\n  }, commentList.map(function (e) {\n    return __jsx(\"li\", {\n      key: e.comment,\n      className: \"jsx-3581091881\"\n    }, __jsx(\"p\", {\n      className: \"jsx-3581091881\"\n    }, e.comment, \"\\uD83D\\uDC97\"));\n  })), __jsx(\"form\", {\n    ref: ref,\n    onSubmit: addComment,\n    hidden: true,\n    className: \"jsx-3581091881\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    name: \"comment\",\n    onChange: inputEv,\n    value: message,\n    required: true,\n    placeholder: \"\\u8F93\\u5165\\u5185\\u5BB9\",\n    className: \"jsx-3581091881\"\n  }), __jsx(\"div\", {\n    onClick: function onClick(e) {\n      e.target.closest('.button').nextElementSibling.click();\n    },\n    className: \"jsx-3581091881\" + \" \" + \"button\"\n  }, __jsx(\"div\", {\n    className: \"jsx-3581091881\" + \" \" + \"rot\"\n  }, __jsx(\"i\", {\n    className: \"jsx-3581091881\" + \" \" + 'iconfont icon-send'\n  }))), __jsx(\"input\", {\n    type: \"submit\",\n    value: \"add\",\n    hidden: true,\n    className: \"jsx-3581091881\"\n  })), __jsx(_JSXStyle, {\n    id: \"3581091881\"\n  }, [\".button.jsx-3581091881{-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:50%;}\", \".rot.jsx-3581091881{height:4rem;width:4rem;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}\", \"@media (max-width:1400px){.rot.jsx-3581091881{height:3rem;width:3rem;}}\", \".button.jsx-3581091881:hover>.rot.jsx-3581091881{background:#1f2738;color:white;}\", \".ok.jsx-3581091881{background:#1a79ff;color:white;}\", \".button.jsx-3581091881 i.jsx-3581091881{font-size:2rem;}\", \"form.jsx-3581091881{width:100%;height:6vh;background:white;border-radius:24px;margin:4vh 0 0;display:none;}\", \"input[type=submit].jsx-3581091881{color:white;}\", \"form.jsx-3581091881>input.jsx-3581091881{-webkit-flex:9;-ms-flex:9;flex:9;text-align:center;height:100%;border:2px solid #f4f6f8;font-size:3vh;padding:0 2vh;outline:none;}\", \"input[type=text].jsx-3581091881{color:#1a79ff;}\", \"form.jsx-3581091881>input.jsx-3581091881:focus{background:#1f2738;color:white;}\", \".comment-list.jsx-3581091881{width:100%;padding:4vh 0 2vh;background:white;}\", \"ul.jsx-3581091881{width:80%;margin-left:10%;list-style:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}\", \"li.jsx-3581091881{width:100%;min-height:6vh;text-align:center;font-weight:700;border-bottom:1px solid #f4f6f8;background:#eeeef4;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}\", \"li.jsx-3581091881:first-child{border-radius:8px 8px 0;}\", \"li.jsx-3581091881:last-child{border-radius:0 0 8px 8px;}\", \"li.jsx-3581091881:nth-child(even){background:#1a79ff;color:white;}\", \"p.jsx-3581091881{font-size:20px;}\"]));\n});\n\nvar dispatchToProps = function dispatchToProps(dispatch) {\n  return {\n    Click: function Click(post) {\n      dispatch(ADD(post));\n    }\n  };\n};\n\nvar stateToProps = function stateToProps(state) {\n  return {};\n};\n\nexport default connect(null, dispatchToProps, null, {\n  forwardRef: true\n})(FeaturesComment);","map":null,"metadata":{},"sourceType":"module"}