{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport Input from './input.js';\nimport Router from 'next/router';\nimport Loading from '../public/loading';\n\nfunction Form({\n  Ev\n}) {\n  const {\n    0: accountOk,\n    1: setAccountOk\n  } = useState(false);\n  const {\n    0: fetching,\n    1: setFetching\n  } = useState(false); // 账号检测状态\n\n  let buttonRef; // 按钮Ref定义\n\n  let animaRef; // 动画Ref\n\n  let accountRef = React.createRef();\n  let passwordRef = React.createRef(); //提交事件     \n\n  const submitevent = async e => {\n    e.preventDefault();\n    let formdata = new FormData(e.target);\n    setFetching(true);\n    let request = await fetch('http://localhost:3001/login', {\n      method: 'POST',\n      body: formdata,\n      credentials: \"include\"\n    });\n\n    if (request.ok) {\n      let a = document.querySelector('a');\n      a.click();\n    } else {\n      Ev('密码错误');\n    }\n  }; //账号验证事件\n\n\n  const ACCright = e => {\n    if (accountRef.current.children[1].value === '') return Ev('请输入账号');\n\n    if (!accountOk) {\n      e.preventDefault();\n      animaRef.classList.add('require');\n      let account = accountRef.current.children[1].value;\n      fetch(`http://localhost:3001/login/${account}`, {\n        method: 'GET'\n      }).then(res => {\n        try {\n          if (res.ok) {\n            anima();\n            setAccountOk(true);\n          } else {\n            animaRef.classList.remove('require');\n            Ev('账号不存在');\n          }\n        } catch (err) {\n          console.log(err);\n        }\n      });\n\n      const anima = () => {\n        accountRef.current.style.opacity = 0;\n        passwordRef.current.style.opacity = 1;\n        passwordRef.current.style.visibility = true;\n        animaRef.classList.remove('require');\n        buttonRef.classList.remove('buttonstatus');\n      };\n    }\n  }; //动画事件 线条渐变效果\n\n\n  const LineColor = select => {\n    if (select < 1) {\n      animaRef.classList.remove('require');\n    } else {\n      animaRef.classList.add('require');\n    }\n  }; //动画事件 线条渐变效果\n\n\n  const buttonColor = select => {\n    if (select < 1) {\n      buttonRef.classList.remove('buttonstatus');\n    } else {\n      buttonRef.classList.add('buttonstatus');\n    }\n  };\n\n  useEffect(() => {\n    foucsAc();\n  }, []);\n\n  const foucsAc = () => {\n    accountRef.current.children[1].focus();\n  };\n\n  return __jsx(\"div\", {\n    id: \"accform\",\n    className: \"jsx-608577747\"\n  }, __jsx(\"a\", {\n    href: \"http://localhost:3000/home\",\n    style: {\n      display: 'none'\n    },\n    className: \"jsx-608577747\"\n  }, \" click\"), __jsx(\"form\", {\n    onSubmit: submitevent,\n    className: \"jsx-608577747\"\n  }, __jsx(\"div\", {\n    className: \"jsx-608577747\" + \" \" + \"div\"\n  }, __jsx(Input, {\n    event: LineColor,\n    buevent: buttonColor,\n    type: \"account\",\n    ref: accountRef\n  }), __jsx(Input, {\n    event: LineColor,\n    buevent: buttonColor,\n    type: \"password\",\n    ref: passwordRef\n  })), __jsx(\"div\", {\n    ref: ref => animaRef = ref,\n    className: \"jsx-608577747\" + \" \" + 'anima'\n  }), __jsx(\"button\", {\n    ref: ref => buttonRef = ref,\n    onClick: ACCright,\n    className: \"jsx-608577747\"\n  }, !fetching ? 'continue' : __jsx(Loading, {\n    color: \"white\"\n  }))), __jsx(_JSXStyle, {\n    id: \"608577747\"\n  }, [\"#accform.jsx-608577747{width:30%;margin:0 auto;margin-top:10vh;position:relative;-webkit-transition:display 1s;transition:display 1s;}\", \"@media (max-width:900px){#accform.jsx-608577747{width:80%;}}\", \"#accform.jsx-608577747 .div.jsx-608577747{min-height:5vh;}\", \"#accform.jsx-608577747 form.jsx-608577747{position:relative;}\", \"#accform.jsx-608577747 button.jsx-608577747{margin-top:3vh;width:100%;height:6vh;border-radius:6px;font-size:3vh;color:white;background:#1f2738;display:block;opacity:0.81;border:none;-webkit-transition:all 0.4s;transition:all 0.4s;}\", \"#accform.jsx-608577747 .buttonstatus.jsx-608577747{background:white;color:#1f2738;opacity:1;-webkit-transition:all 0.4s;transition:all 0.4s;}\", \"#accform.jsx-608577747 .require.jsx-608577747{-webkit-animation:account-jsx-608577747 1.5s infinite;animation:account-jsx-608577747 1.5s infinite;}\", \"#accform.jsx-608577747 div.anima.jsx-608577747{width:100%;height:2px;background:white;-webkit-transition:-webkit-transform 1s;-webkit-transition:transform 1s;transition:transform 1s;-webkit-transform:scale(1,1);-ms-transform:scale(1,1);transform:scale(1,1);-webkit-transform-origin:right 50%;-ms-transform-origin:right 50%;transform-origin:right 50%;}\", \"#accform.jsx-608577747 div.go.jsx-608577747{height:2px;-webkit-transform:scale(0,1);-ms-transform:scale(0,1);transform:scale(0,1);-webkit-transform-origin:left 50%;-ms-transform-origin:left 50%;transform-origin:left 50%;-webkit-transition:-webkit-transform 0.5s;-webkit-transition:transform 0.5s;transition:transform 0.5s;}\", \"@-webkit-keyframes account-jsx-608577747{0%{background:#1f273b;}25%{background:#1c3255;}50%{background:#495e87;}75%{background:#7482ab;}100%{background:#1f273b;}}\", \"@keyframes account-jsx-608577747{0%{background:#1f273b;}25%{background:#1c3255;}50%{background:#495e87;}75%{background:#7482ab;}100%{background:#1f273b;}}\"]));\n}\n\nexport default Form;","map":null,"metadata":{},"sourceType":"module"}